"use strict";(self.webpackChunkmlflow_oidc_auth_front=self.webpackChunkmlflow_oidc_auth_front||[]).push([[398],{4398:(de,A,m)=>{m.r(A),m.d(A,{AdminPageModule:()=>le});var S=m(6895),U=m(4006),d=m(9197),g=m(3732),p=m(8505),a=m(3900),E=m(9300),c=(()=>{return(t=c||(c={})).EDIT="EDIT",t.DELETE="DELETE",t.REVOKE="REVOKE",t.ADD="ADD",t.MANAGE="MANAGE",c;var t})();const u={ADD:{name:"Add",icon:"add",action:c.ADD},EDIT:{name:"Edit",icon:"edit",action:c.EDIT},DELETE:{name:"Delete",icon:"delete",action:c.DELETE},REVOKE:{name:"Revoke",icon:"key_off",action:c.REVOKE}},O=[u.EDIT,u.REVOKE],N=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];var i=m(4650),v=m(5938),l=m(705),P=m(2590),Z=m(5057),k=m(4945);let _=(()=>{class t{constructor(e,s,n){this.dialog=e,this.permissionDataService=s,this.modelDataService=n}openEditUserPermissionsForModelModal(e,s,n){return this.dialog.open(g.jA,{data:{userName:s,entityName:e,entityType:P.W.MODEL,permission:n}}).afterClosed().pipe((0,E.h)(Boolean),(0,a.w)(({permission:h})=>this.permissionDataService.updateModelPermission({name:e,permission:h,user_name:s})))}openEditUserPermissionsForExperimentModal(e,s,n){return this.dialog.open(g.jA,{data:{userName:s,entityName:e,entityType:P.W.EXPERIMENT,permission:n}}).afterClosed().pipe((0,E.h)(Boolean),(0,a.w)(({permission:h})=>this.permissionDataService.updateExperimentPermission({experiment_id:e,permission:h,user_name:s})))}openGrantModelPermissionModal(e){return this.modelDataService.getAllModels().pipe((0,a.w)(s=>this.dialog.open(g.Rt,{data:{entityType:P.W.MODEL,entities:s.map(({name:n})=>n),userName:e}}).afterClosed()))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(v.uw),i.LFG(Z.P),i.LFG(k.$))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=m(6709),x=m(7392),T=m(4859);let w=(()=>{class t{constructor(e,s,n,o,h,D,C){this.dialog=e,this.experimentDataService=s,this.permissionDataService=n,this.userDataService=o,this.route=h,this.permissionModalService=D,this.snackBarService=C,this.userColumnConfig=N,this.actions=O,this.userDataSource=[]}ngOnInit(){this.experimentId=this.route.snapshot.paramMap.get("id")??"",this.experimentDataService.getUsersForExperiment(this.experimentId).subscribe(e=>{this.userDataSource=e})}handleUserEdit(e){this.permissionModalService.openEditUserPermissionsForExperimentModal(this.experimentId,e.username,e.permission).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,a.w)(()=>this.experimentDataService.getUsersForExperiment(this.experimentId))).subscribe(s=>{this.userDataSource=s})}handleActions(e){const n={[c.EDIT]:this.handleUserEdit.bind(this),[c.REVOKE]:this.revokePermissionForUser.bind(this)}[e.action.action];n&&n(e.item)}revokePermissionForUser(e){this.permissionDataService.deleteExperimentPermission({experiment_id:this.experimentId,user_name:e.username}).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,a.w)(()=>this.loadUsersForExperiment(this.experimentId))).subscribe(s=>this.userDataSource=s)}addUser(){this.userDataService.getAllUsers().pipe((0,a.w)(({users:e})=>this.dialog.open(g.LP,{data:{users:e}}).afterClosed()),(0,E.h)(Boolean),(0,a.w)(({user:e,permission:s})=>this.permissionDataService.createExperimentPermission({experiment_id:this.experimentId,permission:s,user_name:e})),(0,a.w)(()=>this.loadUsersForExperiment(this.experimentId))).subscribe(e=>this.userDataSource=e)}loadUsersForExperiment(e){return this.experimentDataService.getUsersForExperiment(e)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(v.uw),i.Y36(l.jR),i.Y36(l.PQ),i.Y36(l.Mn),i.Y36(d.gz),i.Y36(_),i.Y36(l.cw))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-experiment-permission-details"]],decls:10,vars:3,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&(i.TgZ(0,"div",0)(1,"div",1)(2,"h3"),i._uU(3,"Experiment Access"),i.qZA(),i.TgZ(4,"button",2),i.NdJ("click",function(){return s.addUser()}),i.TgZ(5,"mat-icon"),i._uU(6,"add"),i.qZA(),i.TgZ(7,"span"),i._uU(8,"Add"),i.qZA()()(),i.TgZ(9,"ml-table",3),i.NdJ("action",function(o){return s.handleActions(o)}),i.qZA()()),2&e&&(i.xp6(9),i.Q6J("columnConfig",s.userColumnConfig)("data",s.userDataSource)("actions",s.actions))},dependencies:[f.a,x.Hw,T.lW]}),t})();const B=[u.EDIT,u.REVOKE],Y=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];function L(t,r){if(1&t){const e=i.EpF();i.TgZ(0,"ml-table",4),i.NdJ("action",function(n){i.CHM(e);const o=i.oxw();return i.KtG(o.handleActions(n))}),i.qZA()}if(2&t){const e=i.oxw();i.Q6J("columnConfig",e.userColumnConfig)("data",e.userDataSource)("actions",e.actions)}}let R=(()=>{class t{constructor(e,s,n,o,h,D,C){this.dialog=e,this.route=s,this.modelDataService=n,this.permissionDataService=o,this.userDataService=h,this.snackService=D,this.permissionModalService=C,this.userDataSource=[],this.userColumnConfig=Y,this.actions=B}ngOnInit(){this.modelId=this.route.snapshot.paramMap.get("id")??"",this.loadUsersForModel(this.modelId).subscribe(e=>{this.userDataSource=e})}revokePermissionForUser(e){this.permissionDataService.deleteModelPermission({name:this.modelId,user_name:e.username}).pipe((0,p.b)(()=>this.snackService.openSnackBar("Permission revoked successfully")),(0,a.w)(()=>this.loadUsersForModel(this.modelId))).subscribe(s=>this.userDataSource=s)}editPermissionForUser({username:e,permission:s}){this.permissionModalService.openEditUserPermissionsForModelModal(this.modelId,e,s).pipe((0,p.b)(()=>this.snackService.openSnackBar("Permission updated")),(0,a.w)(()=>this.loadUsersForModel(this.modelId))).subscribe(n=>{this.userDataSource=n})}handleActions({action:e,item:s}){const o={[c.REVOKE]:this.revokePermissionForUser.bind(this),[c.EDIT]:this.editPermissionForUser.bind(this)}[e.action];o&&o(s)}loadUsersForModel(e){return this.modelDataService.getUsersForModel(e)}addUser(){this.userDataService.getAllUsers().pipe((0,a.w)(({users:e})=>this.dialog.open(g.LP,{data:{users:e}}).afterClosed()),(0,E.h)(Boolean),(0,a.w)(({user:e,permission:s})=>this.permissionDataService.createModelPermission({name:this.modelId,permission:s,user_name:e})),(0,a.w)(()=>this.loadUsersForModel(this.modelId))).subscribe(e=>{this.userDataSource=e})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(v.uw),i.Y36(d.gz),i.Y36(l.$N),i.Y36(l.PQ),i.Y36(l.Mn),i.Y36(l.cw),i.Y36(_))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-model-permission-details"]],decls:10,vars:1,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&(i.TgZ(0,"div",0)(1,"div",1)(2,"h3"),i._uU(3,"Model Access"),i.qZA(),i.TgZ(4,"button",2),i.NdJ("click",function(){return s.addUser()}),i.TgZ(5,"mat-icon"),i._uU(6,"add"),i.qZA(),i.TgZ(7,"span"),i._uU(8,"Add"),i.qZA()()(),i.YNc(9,L,1,3,"ml-table",3),i.qZA()),2&e&&(i.xp6(9),i.Q6J("ngIf",s.userDataSource.length))},dependencies:[S.O5,f.a,x.Hw,T.lW]}),t})();var J=m(4128);const G=[{title:"Model name",key:"name"},{title:"Permissions",key:"permissions"}],K=[{title:"Experiment Name",key:"name"},{title:"Permission",key:"permissions"}],Q=[u.EDIT,u.REVOKE],X=[u.EDIT,u.REVOKE];var M=m(3848);function V(t,r){if(1&t){const e=i.EpF();i.TgZ(0,"ml-table",6),i.NdJ("action",function(n){i.CHM(e);const o=i.oxw();return i.KtG(o.handleExperimentActions(n))}),i.qZA()}if(2&t){const e=i.oxw();i.Q6J("columnConfig",e.experimentsColumnConfig)("data",e.experimentsDataSource)("actions",e.experimentsActions)}}function z(t,r){if(1&t){const e=i.EpF();i.TgZ(0,"ml-table",6),i.NdJ("action",function(n){i.CHM(e);const o=i.oxw();return i.KtG(o.handleModelActions(n))}),i.qZA()}if(2&t){const e=i.oxw();i.Q6J("columnConfig",e.modelsColumnConfig)("data",e.modelsDataSource)("actions",e.modelsActions)}}let H=(()=>{class t{constructor(e,s,n,o,h,D,C){this.dialog=e,this.expDataService=s,this.modelDataService=n,this.permissionDataService=o,this.route=h,this.permissionModalService=D,this.snackBarService=C,this.userId="",this.experimentsColumnConfig=K,this.modelsColumnConfig=G,this.experimentsDataSource=[],this.modelsDataSource=[],this.experimentsActions=Q,this.modelsActions=X}ngOnInit(){this.userId=this.route.snapshot.paramMap.get("id")??"",(0,J.D)([this.expDataService.getExperimentsForUser(this.userId),this.modelDataService.getModelsForUser(this.userId)]).subscribe(([e,s])=>{this.experimentsDataSource=e,this.modelsDataSource=s})}addModelPermissionToUser(){this.permissionModalService.openGrantModelPermissionModal(this.userId).pipe((0,E.h)(Boolean),(0,a.w)(({entity:e,permission:s})=>this.permissionDataService.createModelPermission({user_name:this.userId,name:e,permission:s})),(0,p.b)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,a.w)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(e=>this.modelsDataSource=e)}addExperimentPermissionToUser(){this.expDataService.getAllExperiments().pipe((0,a.w)(e=>this.dialog.open(g.Rt,{data:{entityType:P.W.EXPERIMENT,entities:e.map(({name:s})=>s),userName:this.userId}}).afterClosed()),(0,E.h)(Boolean),(0,a.w)(({entity:e,permission:s})=>this.permissionDataService.createExperimentPermission({user_name:this.userId,experiment_name:e,permission:s})),(0,p.b)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,a.w)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(e=>this.experimentsDataSource=e)}handleExperimentActions(e){const n={[c.EDIT]:this.handleEditUserPermissionForExperiment.bind(this),[c.REVOKE]:this.revokeExperimentPermissionForUser.bind(this)}[e.action.action];n&&n(e.item)}revokeExperimentPermissionForUser(e){this.permissionDataService.deleteExperimentPermission({experiment_id:e.id,user_name:this.userId}).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,a.w)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(s=>this.experimentsDataSource=s)}revokeModelPermissionForUser({name:e}){this.permissionDataService.deleteModelPermission({name:e,user_name:this.userId}).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,a.w)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(s=>this.modelsDataSource=s)}handleModelActions({action:e,item:s}){const o={[c.EDIT]:this.handleEditUserPermissionForModel.bind(this),[c.REVOKE]:this.revokeModelPermissionForUser.bind(this)}[e.action];o&&o(s)}handleEditUserPermissionForModel({name:e,permissions:s}){this.permissionModalService.openEditUserPermissionsForModelModal(e,this.userId,s).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,a.w)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(n=>this.modelsDataSource=n)}handleEditUserPermissionForExperiment({id:e,permissions:s}){this.permissionModalService.openEditUserPermissionsForExperimentModal(e,this.userId,s).pipe((0,p.b)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,a.w)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(n=>this.experimentsDataSource=n)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(v.uw),i.Y36(l.jR),i.Y36(l.$N),i.Y36(l.PQ),i.Y36(d.gz),i.Y36(_),i.Y36(l.cw))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-user-permission-details"]],decls:19,vars:2,consts:[["label","Experiments"],[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action",4,"ngIf"],["label","Models"],[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&(i.TgZ(0,"mat-tab-group")(1,"mat-tab",0)(2,"div",1)(3,"div",2)(4,"button",3),i.NdJ("click",function(){return s.addExperimentPermissionToUser()}),i.TgZ(5,"mat-icon"),i._uU(6,"add"),i.qZA(),i.TgZ(7,"span"),i._uU(8,"Add"),i.qZA()()(),i.YNc(9,V,1,3,"ml-table",4),i.qZA()(),i.TgZ(10,"mat-tab",5)(11,"div",1)(12,"div",2)(13,"button",3),i.NdJ("click",function(){return s.addModelPermissionToUser()}),i.TgZ(14,"mat-icon"),i._uU(15,"add"),i.qZA(),i.TgZ(16,"span"),i._uU(17,"Add"),i.qZA()()(),i.YNc(18,z,1,3,"ml-table",4),i.qZA()()()),2&e&&(i.xp6(9),i.Q6J("ngIf",s.experimentsDataSource.length),i.xp6(9),i.Q6J("ngIf",s.modelsDataSource.length))},dependencies:[S.O5,f.a,x.Hw,T.lW,M.SP,M.uX],styles:[".header-section[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:36px}.header-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;padding:0}"]}),t})(),j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-admin-page"]],decls:1,vars:0,template:function(e,s){1&e&&i._UZ(0,"router-outlet")},dependencies:[d.lC],encapsulation:2}),t})();const W=[{title:"User name",key:"user"}],q=[u.EDIT];let $=(()=>{class t{constructor(e,s,n){this.router=e,this.route=s,this.userDataService=n,this.columnConfig=W,this.actions=q,this.dataSource=[]}ngOnInit(){this.userDataService.getAllUsers().subscribe(({users:e})=>this.dataSource=e.map(s=>({user:s})))}handleItemAction({action:e,item:s}){const o={[c.EDIT]:this.handleUserEdit.bind(this)}[e.action];o&&o(s)}handleUserEdit({user:e}){this.router.navigate(["../user/"+e],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(d.F0),i.Y36(d.gz),i.Y36(l.Mn))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-user-permissions"]],decls:1,vars:3,consts:[[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&(i.TgZ(0,"ml-table",0),i.NdJ("action",function(o){return s.handleItemAction(o)}),i.qZA()),2&e&&i.Q6J("columnConfig",s.columnConfig)("data",s.dataSource)("actions",s.actions)},dependencies:[f.a]}),t})();const ee=[{action:c.EDIT,icon:"edit",name:"Edit"}],ie=[{title:"Experiment Name",key:"name"}];let se=(()=>{class t{constructor(e,s,n){this.router=e,this.route=s,this.experimentDataService=n,this.columnConfig=ie,this.dataSource=[],this.actions=ee}ngOnInit(){this.experimentDataService.getAllExperiments().subscribe(e=>this.dataSource=e)}handleActions(e){const n={[c.EDIT]:this.handleExperimentEdit.bind(this)}[e.action.action];n&&n(e.item)}handleExperimentEdit({id:e}){this.router.navigate(["../experiment/"+e],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(d.F0),i.Y36(d.gz),i.Y36(l.jR))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-experiment-permissions"]],decls:1,vars:3,consts:[[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&(i.TgZ(0,"ml-table",0),i.NdJ("action",function(o){return s.handleActions(o)}),i.qZA()),2&e&&i.Q6J("columnConfig",s.columnConfig)("data",s.dataSource)("actions",s.actions)},dependencies:[f.a]}),t})();const te=[{title:"Model Name",key:"name"}],ne=[u.EDIT];function oe(t,r){if(1&t){const e=i.EpF();i.TgZ(0,"ml-table",1),i.NdJ("action",function(n){i.CHM(e);const o=i.oxw();return i.KtG(o.handleAction(n))}),i.qZA()}if(2&t){const e=i.oxw();i.Q6J("columnConfig",e.columnConfig)("data",e.dataSource)("actions",e.actions)}}let re=(()=>{class t{constructor(e,s,n){this.route=e,this.router=s,this.modelDataService=n,this.columnConfig=te,this.dataSource=[],this.actions=ne}ngOnInit(){this.modelDataService.getAllModels().subscribe(e=>{this.dataSource=e})}handleModelEdit({name:e}){this.router.navigate(["../model/"+e],{relativeTo:this.route})}handleAction({action:e,item:s}){const o={[c.EDIT]:this.handleModelEdit.bind(this)}[e.action];o&&o(s)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(d.gz),i.Y36(d.F0),i.Y36(l.$N))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-model-permissions"]],decls:1,vars:1,consts:[[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"columnConfig","data","actions","action"]],template:function(e,s){1&e&&i.YNc(0,oe,1,3,"ml-table",0),2&e&&i.Q6J("ngIf",s.dataSource.length)},dependencies:[S.O5,f.a]}),t})();const ae=[{path:"",component:j,children:[{path:"permissions",component:(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ml-permissions"]],decls:10,vars:0,consts:[["label","Users permissions"],[1,"my-3"],["label","Experiment permissions"],["label","Model permissions"]],template:function(e,s){1&e&&(i.TgZ(0,"mat-tab-group")(1,"mat-tab",0)(2,"div",1),i._UZ(3,"ml-user-permissions"),i.qZA()(),i.TgZ(4,"mat-tab",2)(5,"div",1),i._UZ(6,"ml-experiment-permissions"),i.qZA()(),i.TgZ(7,"mat-tab",3)(8,"div",1),i._UZ(9,"ml-model-permissions"),i.qZA()()())},dependencies:[M.SP,M.uX,$,se,re]}),t})()},{path:"user/:id",component:H},{path:"experiment/:id",component:w},{path:"model/:id",component:R},{path:"**",redirectTo:"permissions"}]}];let me=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[d.Bz.forChild(ae),d.Bz]}),t})();var ce=m(3912);let le=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[S.ez,ce.m,me,U.u5,d.Bz]}),t})()}}]);