"use strict";(self.webpackChunkAutoGen_Studio=self.webpackChunkAutoGen_Studio||[]).push([[591],{43881:function(e,t,l){l.d(t,{A:function(){return k}});l(9391);var n=l(96540);var a=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})),r=l(23955),s=l(54015);var o=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"}))}));var c=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))})),i=l(26156),m=l(68777),d=l(63532),u=l(34267),g=l(46795),p=l(70870),v=l(92744);var h=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}));var f=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}));var E=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"}))})),b=l(72850),y=l(36647);var w=e=>{let{metadata:t}=e;const l=(0,p.Tt)(),a=(t.files||[]).map(((e,t)=>n.createElement("div",{key:"metafilesrow"+t,className:"text-primary "},((e,t)=>{const a=e.extension,r=["image"].includes(e.type),s=["code"].includes(e.type),o=["csv"].includes(e.type),c=["pdf"].includes(e.type),i=["video"].includes(e.type),m=e.name||"unknown",d=e.path||"unknown";let u=null,g=n.createElement("div",null,"image"===e.type?n.createElement(h,{className:"h-4 mr-1 inline-block"}):n.createElement(f,{className:"h-4 mr-1 inline-block"})," ",n.createElement("span",{className:"break-all "},m)," "),p=n.createElement("div",{className:"p-2 bg-secondary rounded flex items-center justify-center   h-full"},n.createElement("div",{className:""},n.createElement("div",{style:{fontSize:"2em"},className:"  text-center mb-2"},e.extension),n.createElement("div",null,g)));return r?(u=n.createElement("div",null,n.createElement("div",{className:"mb-2"},g),n.createElement(b.$N,{src:l+"/"+d,className:"w-full rounded"})),p=u):i?(u=n.createElement("div",{className:"mb-2"},n.createElement("a",{href:l+"/"+d},g),n.createElement("video",{controls:!0,className:"w-full rounded"},n.createElement("source",{src:l+"/"+d,type:"video/"+a}),"Your browser does not support the video tag.")),p=n.createElement("div",{className:"   relative rounded   h-full"},n.createElement("div",{className:"absolute rounded p-2 bg-secondary top-0 "},g),n.createElement("div",{style:{minHeight:"150px"},className:"bg-secondary h-full w-full rounded  flex items-center justify-center text-primary "},n.createElement(E,{className:"h-14 w-14"})))):o?(u=n.createElement("div",{className:"h"},n.createElement("a",{href:l+"/"+d},n.createElement("div",{className:"mb-4"},g)),n.createElement(b.Il,{csvUrl:l+"/"+d,className:"w-full rounded"})),p=n.createElement("div",{className:"   relative rounded   h-full"},n.createElement("div",{className:"absolute rounded p-2 bg-secondary top-0 "},g),n.createElement("div",{style:{minHeight:"150px"},className:"bg-secondary  h-full w-full rounded  flex items-center justify-center text-primary"},n.createElement(y.A,{icon:"csv",size:14})))):s?(u=n.createElement("div",{className:"h"},n.createElement("a",{href:l+"/"+d,target:"_blank",rel:"noopener noreferrer"},n.createElement("div",{className:"mb-4"},g)),n.createElement(b.vK,{url:l+"/"+d,className:"w-full rounded"})),p=n.createElement("div",{className:"   relative rounded   h-full"},n.createElement("div",{className:"absolute rounded p-2 bg-secondary top-0 "},g),n.createElement("div",{style:{minHeight:"150px"},className:"bg-secondary  h-full w-full rounded  flex items-center justify-center text-primary"},n.createElement(y.A,{icon:"python",size:14})))):c?(u=n.createElement("div",{className:"h-full"},n.createElement("div",{className:"mb-4"},n.createElement("a",{href:l+"/"+d,target:"_blank",rel:"noopener noreferrer"},g)),n.createElement(b.H6,{url:l+"/"+d})),p=n.createElement("div",{className:"   relative rounded   h-full"},n.createElement("div",{className:"absolute rounded p-2 bg-secondary top-0 "},g),n.createElement("div",{style:{minHeight:"150px"},className:"bg-secondary h-full w-full rounded  flex items-center justify-center text-primary "},n.createElement(y.A,{icon:"pdf",size:14})))):u=n.createElement("span",null,"Unsupported file type."),n.createElement("div",{className:"  h-full rounded"},n.createElement(b.GM,{className:"mb-1",icon:p,title:m},u))})(e)))),r=(t.messages||[]).map(((e,t)=>n.createElement("div",{className:" mb-2 border-dashed",key:"messagerow"+t},n.createElement(b.yP,{message:e})))),s=a.length>0,o=r.length>0;return n.createElement("div",null,o&&n.createElement("div",{className:"rounded   bg-primary  "},n.createElement(b.Jv,{open:!1,title:"Agent Messages ("+r.length+" message"+(r.length>1?"s":"")+") | "+(0,p.a3)(null==t?void 0:t.time)},r)),s&&n.createElement("div",{className:"rounded mt-2"},n.createElement(b.Jv,{open:!0,title:"Results ("+a.length+" file"+(a.length>1?"s":"")+")"},n.createElement("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},a))))},x=l(8369);let N=[];var k=e=>{var t;let{initMessages:l,editable:h=!0,connectionId:f,fetchMessages:E}=e;const y=(0,x.J)((e=>e.session)),k=n.useRef(null),A=n.useRef(null),{user:j}=n.useContext(v.v),C=n.useRef(null),[S,_]=n.useState("disconnected"),[L,M]=n.useState([]),[H,R]=n.useState(0),O=(0,p.Tt)();let T=O.replace("http","ws")+"/ws/";if(O.includes("http"))T=O.replace("http","ws")+"/ws/";else{const e=window.location.href,t=new URL(e),l=t.protocol,n=t.host;T=(l+"//"+n+O).replace("http","ws")+"/ws/"}const[I,J]=n.useState(!1),[B,W]=n.useState(""),[Z,G]=n.useState({status:!0,message:"All good"}),z=n.useRef(null),U=(0,x.J)((e=>e.messages)),P=(0,x.J)((e=>e.setMessages));let D,K;"undefined"!=typeof window&&(D=window.innerHeight,K=D-310+"px");const V=e=>{let t;try{t=JSON.parse(e.meta)}catch(l){t=e.meta}return{text:e.content,sender:"user"===e.role?"user":"bot",meta:t,msg_id:e.msg_id}},Y=e=>null==e?void 0:e.map(V);n.useEffect((()=>{const e=Y(l);P(e),N=[]}),[l]);const q=p.Mj.map(((e,t)=>n.createElement(m.Ay,{key:"prompt"+t,type:"primary",className:"",onClick:()=>{le(e.prompt)}}," ",e.title," "))),F=null==U?void 0:U.map(((e,t)=>{const l="user"===e.sender,s=l?"bg-accent text-white  ":"bg-light";let o=!1;var c,i,m;e.meta&&(o=null!==e.meta.code||(null===(c=e.meta.images)||void 0===c?void 0:c.length)>0||(null===(i=e.meta.files)||void 0===i?void 0:i.length)>0||(null===(m=e.meta.scripts)||void 0===m?void 0:m.length)>0);let g=[];l&&(g.push({label:n.createElement("div",{onClick:()=>{console.log("retrying"),le(e.text)}},n.createElement(a,{role:"button",title:"Retry",className:"h-4 w-4 mr-1 inline-block"}),"Retry"),key:"retrymessage"}),g.push({label:n.createElement("div",{onClick:()=>{navigator.clipboard.writeText(e.text),d.Ay.success("Message copied to clipboard")}},n.createElement(r.A,{role:"button",title:"Copy",className:"h-4 w-4 mr-1 inline-block"}),"Copy"),key:"copymessage"}));const p=n.createElement(u.A,{menu:{items:g},trigger:["click"],placement:"bottomRight"},n.createElement("div",{role:"button",className:"float-right ml-2 duration-100 hover:bg-secondary font-semibold px-2 pb-1  rounded"},n.createElement("span",{className:"block -mt-2 text-primary  "}," ...")));return n.createElement("div",{className:"align-right "+(l?"text-righpt":"")+"  mb-2 border-b",key:"message"+t}," ",n.createElement("div",{className:"  "+(l?"":" w-full")+" inline-flex gap-2"},n.createElement("div",{className:""}),n.createElement("div",{className:"font-semibold text-secondary text-sm w-16"},l?"USER":"AGENTS"),n.createElement("div",{className:"inline-block group relative w-full p-2 rounded  "+s}," ",g.length>0&&h&&n.createElement("div",{className:" group-hover:opacity-100 opacity-0 "},p),l&&n.createElement(n.Fragment,null,n.createElement("div",{className:"inline-block"},e.text)),!l&&n.createElement("div",{className:" w-full chatbox prose dark:prose-invert text-primary rounded "},n.createElement(b.pO,{className:"text-sm",data:e.text,showCode:!1})),e.meta&&n.createElement("div",{className:""},n.createElement(w,{metadata:e.meta})))))}));n.useEffect((()=>{setTimeout((()=>{ee(A)}),500)}),[U]);const $="50px";n.useEffect((()=>{!1===I&&k.current&&k.current&&(null===Z||Z&&!1===Z.status)&&(k.current.value="",k.current.style.height=$)}),[I]),n.useEffect((()=>{if(k.current){k.current.style.height=$;const e=k.current.scrollHeight;k.current.style.height=e+"px"}}),[B]);const[Q,X]=n.useState(null);n.useEffect((()=>{if(Q)return;const e=T+f;if(console.log("socketUrl",e),!C.current){const t=new WebSocket(e);return C.current=t,t.onerror=e=>{console.log("ws error",e)},t.onopen=()=>{_("connected"),console.log("ws opened")},t.onclose=()=>{C.current&&(console.log("ws closed by server"),Q||(_("disconnected"),X(!0),_("reconnecting"),setTimeout((()=>{X(null)}),2e3)))},t.onmessage=e=>{const t=JSON.parse(e.data);if(console.log("received message",t),t&&"agent_message"===t.type){const e=Object.assign([],L);e.push(t.data),M(e),N.push(t.data),setTimeout((()=>{ee(z),ee(A)}),200)}else if(t&&"agent_status"===t.type){const e=document.getElementById("agentstatusspan");e&&(e.innerHTML=t.data.message)}else t&&"agent_response"===t.type&&te(t.data)},()=>{console.log("Cleanup"),C.current=null,t.close()}}}),[Q]);const ee=e=>{var t;null===(t=e.current)||void 0===t||t.scroll({top:e.current.scrollHeight,behavior:"smooth"})},te=e=>{if(e&&e.status){console.log("received proc data",e);const t=O+"/messages?user_id="+(null==j?void 0:j.email)+"&session_id="+e.data.session_id,l={method:"GET",headers:{"Content-Type":"application/json"}},n=e=>{if(e&&e.status){const t=Y(e.data);P(t)}else d.Ay.error(e.message);J(!1)},a=e=>{G(e),d.Ay.error(e.message),J(!1)};(0,p.hI)(t,l,n,a)}else console.log("error",e),d.Ay.error(e.message),J(!1)},le=e=>{G(null),N=[];let t=Object.assign([],U);const l={text:e,sender:"user",msg_id:(0,p.Os)()};t.push(l),P(t);const n={role:"user",content:e,user_id:(null==j?void 0:j.email)||"",session_id:null==y?void 0:y.id,workflow_id:null==y?void 0:y.workflow_id,connection_id:f};console.log("messagePayload",n);const a=O+"/messages",r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};J(!0),C.current&&1===C.current.readyState?(C.current.send(JSON.stringify({connection_id:f,data:n,type:"user_message"})),console.log("sending on socket ..")):fetch(a,r).then((e=>{200===e.status?e.json().then((e=>{te(e)})):(e.json().then((e=>{console.log("error",e),d.Ay.error(e.message),J(!1)})),d.Ay.error("Connection error. Ensure server is up and running."))})).catch((()=>{J(!1),d.Ay.error("Connection error. Ensure server is up and running.")})).finally((()=>{setTimeout((()=>{ee(A)}),500)}))};return n.createElement("div",{style:{height:"calc(100vh - 160px)"},className:"text-primary    relative  h-full rounded  "},n.createElement("div",{style:{zIndex:100},className:" absolute right-0  text-secondary -top-8 rounded p-2"}," ",n.createElement("div",{className:"text-xs"}," ",null==y?void 0:y.name)),n.createElement("div",{ref:A,className:"flex h-full  flex-col rounded  scroll pr-2 overflow-auto  ",style:{minHeight:"30px",height:"calc(100vh - 310px)"}},n.createElement("div",{className:"scroll-gradient h-10"}," ",n.createElement("span",{className:"  inline-block h-6"})," "),n.createElement("div",{className:"flex-1  boder mt-4"}),!U&&null!==U&&n.createElement("div",{className:"w-full text-center boder mt-4"},n.createElement("div",null," ",n.createElement(b.g0,null)),"loading messages"),U&&0===(null==U?void 0:U.length)&&n.createElement("div",{className:"ml-2 text-sm text-secondary "},n.createElement(s.A,{className:"inline-block h-6 mr-2"}),"No messages in the current session. Start a conversation to begin."),n.createElement("div",{className:"ml-2"}," ",F),I&&n.createElement("div",{className:" inline-flex gap-2 duration-300 "},n.createElement("div",{className:""}),n.createElement("div",{className:"font-semibold text-secondary text-sm w-16"},"AGENTS"),n.createElement("div",{className:"relative w-full  "},n.createElement("div",{className:"mb-2  "},n.createElement(b.Gm,null,n.createElement("div",{className:"mb-1  inline-block ml-2 text-xs text-secondary"},n.createElement("span",{className:"innline-block text-sm ml-2"}," ",n.createElement("span",{id:"agentstatusspan"}," ","agents working on task .."))," ",N.length>0&&n.createElement("span",{className:"border-l inline-block text-right ml-2 pl-2"},N.length," agent message",N.length>1&&"s"," sent/received.")))),N.length>0&&n.createElement("div",{ref:z,style:{minHeight:"300px",maxHeight:"400px",overflowY:"auto"},className:"inline-block scroll group relative   p-2 rounded w-full bg-light "},n.createElement(b.Jv,{open:!0,title:"Agent Messages ("+N.length+" message"+(N.length>1?"s":"")+") "},null===(t=N)||void 0===t?void 0:t.map(((e,t)=>n.createElement("div",{key:t},n.createElement(b.yP,{message:e}))))))))),h&&n.createElement("div",{className:"mt-2 p-2 absolute   bg-primary  bottom-0 w-full"},n.createElement("div",{className:"rounded p-2 shadow-lg flex mb-1  gap-2 "+(I?" opacity-50 pointer-events-none":"")},n.createElement("form",{autoComplete:"on",className:"flex-1 relative",onSubmit:e=>{e.preventDefault()}},n.createElement("textarea",{id:"queryInput",name:"queryInput",autoComplete:"on",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||k.current&&!I&&(e.preventDefault(),le(k.current.value))},onChange:e=>{W(e.target.value)},placeholder:"Write message here...",ref:k,className:"flex items-center w-full resize-none text-gray-600 bg-white p-2 ring-2 rounded-sm pl-5 pr-16",style:{maxHeight:"120px",overflowY:"auto"}}),n.createElement("div",{role:"button",style:{width:"45px",height:"35px"},title:"Send message",onClick:()=>{k.current&&!I&&le(k.current.value)},className:"absolute right-3 bottom-2 bg-accent hover:brightness-75 transition duration-300 rounded cursor-pointer flex justify-center items-center"}," ",!I&&n.createElement("div",{className:"inline-block  "},n.createElement(o,{className:"h-6 w-6 text-white "})," "),I&&n.createElement("div",{className:"inline-block   "},n.createElement(c,{className:"text-white animate-spin rounded-full h-6 w-6"})))))," ",n.createElement("div",null,n.createElement("div",{className:"mt-2 text-xs text-secondary"},n.createElement(g.A,{title:"Socket "+S},n.createElement("div",{className:"w-1 h-3 rounded  inline-block mr-1 "+(ne=S,"connected"===ne?"bg-green-500":"reconnecting"===ne?"bg-orange-500":"disconnected"===ne?"bg-red-500":void 0)})," "),"Blank slate? Try one of the example prompts below"," "),n.createElement("div",{className:"mt-2 inline-flex gap-2 flex-wrap  "+(I?"brightness-75 pointer-events-none":"")},q)),Z&&!Z.status&&n.createElement("div",{className:"p-2   rounded mt-4 text-orange-500 text-sm"}," ",n.createElement(i.A,{className:"h-5 text-orange-500 inline-block mr-2"})," ",Z.message)));var ne}},85575:function(e,t,l){var n=l(96540);const a=n.forwardRef((function({title:e,titleId:t,...l},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},l),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}));t.A=a}}]);
//# sourceMappingURL=6c05b3ab656a8bfc225a64b3d73a36a92f83c05e-2d551657447a306e6a50.js.map