(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{41010:function(e,t,r){Promise.resolve().then(r.bind(r,90786))},30695:function(e,t,r){"use strict";r.d(t,{_i:function(){return a},gz:function(){return s},hw:function(){return o},sj:function(){return l},wG:function(){return i}});var n=r(20357);async function i(e,t){var r;let{arg:i}=t,a=await fetch((null!==(r=n.env.NEXT_PUBLIC_API_SERVER)&&void 0!==r?r:"")+e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!(a.status>=200&&a.status<300))throw Error(await a.text());let l=await a.json();if(!a.ok)throw Error(l.message);return l}let a=async function(){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];let a=await fetch((null!==(e=n.env.NEXT_PUBLIC_API_SERVER)&&void 0!==e?e:"")+r[0],r[1]);if(!a.ok)throw Error(await a.text());return a.json()},l=async(e,t)=>{var r;let i=await fetch((null!==(r=n.env.NEXT_PUBLIC_API_SERVER)&&void 0!==r?r:"")+e,t);if(!i.ok)throw Error(await i.text());return i};async function o(e,t){var r;let{arg:i}=t,a=await fetch("".concat(null!==(r=n.env.NEXT_PUBLIC_API_SERVER)&&void 0!==r?r:"").concat(e,"/").concat(i),{method:"DELETE"});if(!a.ok)throw Error(await a.text());return a}async function s(e,t){var r;let{arg:i}=t,a=await fetch("".concat(null!==(r=n.env.NEXT_PUBLIC_API_SERVER)&&void 0!==r?r:"").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)throw Error(await a.text());return a}},12951:function(e,t,r){"use strict";r.d(t,{Bf:function(){return o},JB:function(){return s},ZP:function(){return l}});var n=r(91617),i=r(30695),a=r(2265);function l(){let{data:e,error:t,isLoading:r}=(0,n.ZP)("/v1/streamers",i._i);return{isLoading:r,streamers:e}}function o(){let{data:e,error:t,isLoading:r}=(0,n.ZP)("/v1/users",i._i),[l,o]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(!e||0===e.length)return;let t=async e=>{try{let t=await (0,i._i)("/bili/space/myinfo?user=".concat(e.value),void 0),r=await (0,i.sj)("/bili/proxy?url=".concat(t.data.face)),n=await r.blob();return{...e,name:t.data.name,face:URL.createObjectURL(n)}}catch(n){console.error(n);let t=await (0,i.sj)("/bili/proxy?url=https://i0.hdslb.com/bfs/face/member/noface.jpg"),r=await t.blob();return{...e,name:"Cookie已失效",face:URL.createObjectURL(r)}}};Promise.all(e.map(t)).then(o)},[e]),{isLoading:r,isError:t,biliUsers:l}}function s(){var e;let{data:t,error:r,isLoading:a}=(0,n.ZP)("/bili/archive/pre",i._i);return{isLoading:a,isError:r,typeTree:null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.typelist.map(e=>({label:e.name,value:e.id,children:e.children}))}}},90786:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _}});var n=r(57437),i=r(64378),a=r(71834),l=r(2265),o=r(26018);let s=(0,o.A)(function(e){return l.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.00003 8C6.00003 11.3 8.70003 14 12 14C15.3 14 18 11.3 18 8C18 4.7 15.3 2 12 2C8.70003 2 6.00003 4.7 6.00003 8ZM8.00003 8C8.00003 5.8 9.80003 4 12 4C14.2 4 16 5.8 16 8C16 10.2 14.2 12 12 12C9.80003 12 8.00003 10.2 8.00003 8ZM2.11696 20.5635C2.35145 20.0487 4.65137 15 12 15C12 15 13 15 13 16C13 17 12 17 12 17C5.80002 17 4.00002 21.2 4.00002 21.4C3.80002 21.9 3.20002 22.1 2.70002 21.9C2.10002 21.7 1.90002 21.1 2.10002 20.6C2.10333 20.5934 2.10891 20.5811 2.11691 20.5636L2.11696 20.5635ZM14 17.5C14 17.2239 14.2239 17 14.5 17H15.5C15.7762 17 16 17.2239 16 17.5V18.5C16 18.7761 15.7762 19 15.5 19H14.5C14.2239 19 14 18.7761 14 18.5V17.5ZM14.5 20C14.2239 20 14 20.2239 14 20.5V21.5C14 21.7761 14.2239 22 14.5 22H15.5C15.7762 22 16 21.7761 16 21.5V20.5C16 20.2239 15.7762 20 15.5 20H14.5ZM17 17.5C17 17.2239 17.2239 17 17.5 17H21.5C21.7762 17 22 17.2239 22 17.5V18.5C22 18.7761 21.7762 19 21.5 19H17.5C17.2239 19 17 18.7761 17 18.5V17.5ZM17.5 20C17.2239 20 17 20.2239 17 20.5V21.5C17 21.7761 17.2239 22 17.5 22H21.5C21.7762 22 22 21.7761 22 21.5V20.5C22 20.2239 21.7762 20 21.5 20H17.5Z",fill:"currentColor"}))},"user_list_stroked");var c=r(98964),d=r(87138);let u=(0,o.A)(function(e){return l.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.46752 13.1163L5.35811 10.3767L18.4606 5.46327L13.2405 18.5136L10.8558 14.539C10.8879 14.5139 10.9188 14.4866 10.9483 14.4571L14.4483 10.9571C14.8388 10.5666 14.8388 9.93343 14.4483 9.5429C14.0578 9.15238 13.4246 9.15238 13.0341 9.5429L9.5341 13.0429C9.51048 13.0665 9.48829 13.091 9.46752 13.1163ZM2.82794 9.18953L19.8792 2.79531C20.6927 2.49024 21.4815 3.29634 21.1588 4.10303L14.3487 21.1282C14.0416 21.896 12.9882 21.9804 12.5628 21.2713L8.99069 15.3178C8.91451 15.1909 8.81109 15.0824 8.6879 15.0003L2.62436 10.9579C1.94615 10.5058 2.06473 9.47573 2.82794 9.18953Z",fill:"currentColor"}))},"send_stroked");var h=r(85080),m=r(88684),C=r(30695),f=r(91617),v=r(16463),x=r(36710),g=r(56164),p=r.n(g),w=e=>{let{abbr:t,label:r,value:a,onRemove:l,url:o}=e;return(0,n.jsxs)("div",{className:p().components,children:[(0,n.jsx)(i.qE,{size:"small",src:o,children:t}),(0,n.jsxs)("div",{className:p().info,children:[(0,n.jsx)("div",{className:p().name,children:r}),(0,n.jsx)("div",{className:p().email,children:a})]}),(0,n.jsx)(i.gn,{title:"确定是否要删除？",content:"此操作将不可逆",onConfirm:l,children:(0,n.jsx)(i.zx,{className:p()["semi-icon-close"],type:"danger",theme:"borderless",icon:(0,n.jsx)(x.Z,{})})})]},r)},b=r(77634),y=r(12951),j=e=>{let{onCancel:t,visible:r}=e,{trigger:a}=(0,b.Z)("/v1/users",C.wG),{trigger:o}=(0,b.Z)("/v1/users",C.hw),{biliUsers:s}=(0,y.Bf)(),[d,u]=(0,l.useState)(!1),[h,m]=(0,l.useState)(!1),f=async()=>{var e;let t=await (null===(e=x.current)||void 0===e?void 0:e.validate());m(!0);try{let e=await (0,C._i)("/bili/space/myinfo?user=".concat(null==t?void 0:t.value),void 0);if(e.code)throw console.log(e),Error(e.message);console.log(e),await a({id:0,name:null==t?void 0:t.value,value:null==t?void 0:t.value,platform:"bilibili-cookies"}),u(!1),i.FN.success("创建成功")}catch(t){let e=JSON.parse(t.message);return i.P_.error({title:"创建失败",content:(0,n.jsx)(i.Typography.Paragraph,{style:{maxWidth:450},children:e.error}),style:{width:"min-content"}})}finally{m(!1)}},v=async e=>{try{await o(e),i.FN.success("删除成功")}catch(e){i.P_.error({title:"删除失败",content:(0,n.jsx)(i.Typography.Paragraph,{style:{maxWidth:450},children:e.message}),style:{width:"min-content"}})}},x=(0,l.useRef)();return(0,n.jsxs)(i.Uu,{title:(0,n.jsx)(i.Typography.Title,{heading:4,children:"用户管理"}),visible:r,footer:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,n.jsx)(i.zx,{onClick:()=>{u(!0)},icon:(0,n.jsx)(c.Z,{size:"large"}),style:{marginRight:4,backgroundColor:"rgba(var(--semi-indigo-0), 1)"},children:"新增"})}),headerStyle:{borderBottom:"1px solid var(--semi-color-border)"},bodyStyle:{borderBottom:"1px solid var(--semi-color-border)"},onCancel:t,children:[(0,n.jsx)(i.aV,{className:"component-list-demo-booklist",dataSource:s,split:!1,size:"small",style:{flexBasis:"100%",flexShrink:0},renderItem:e=>(0,n.jsx)(w,{url:e.face,abbr:e.name,label:e.name,value:e.value,onRemove:async()=>await v(e.id)})}),(0,n.jsx)(i.u_,{title:"新建",visible:d,onOk:f,afterClose:()=>{console.log("After Close callback executed")},onCancel:()=>{u(!1),console.log("Cancel button clicked")},closeOnEsc:!0,confirmLoading:h,bodyStyle:{overflow:"auto",maxHeight:"calc(100vh - 320px)",paddingLeft:10,paddingRight:10},children:(0,n.jsx)(i.Form,{getFormApi:e=>x.current=e,children:(0,n.jsx)(i.Form.Input,{field:"value",label:"Cookie路径",trigger:"blur",placeholder:"cookies.json",rules:[{required:!0}]})})})]})};function _(){let{Meta:e}=i.Card,{Header:t,Content:r}=i.Layout,[o,x]=(0,l.useState)(!1),g=(0,v.useRouter)(),{trigger:p}=(0,b.Z)("/v1/upload/streamers",C.hw),{data:w,error:_,isLoading:E}=(0,f.ZP)("/v1/upload/streamers",C._i),{biliUsers:L}=(0,y.Bf)(),Z=()=>{x(!o)},R=async e=>{await p(e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j,{visible:o,onCancel:Z}),(0,n.jsx)(t,{style:{backgroundColor:"var(--semi-color-bg-1)"},children:(0,n.jsx)(i.JL,{header:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{backgroundColor:"rgba(var(--semi-violet-4), 1)",borderRadius:"var(--semi-border-radius-large)",color:"var(--semi-color-bg-0)",display:"flex",padding:"6px"},children:(0,n.jsx)(a.Z,{size:"large"})}),(0,n.jsx)("h4",{style:{marginLeft:"12px"},children:"投稿管理"})]}),mode:"horizontal",footer:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.zx,{onClick:Z,type:"tertiary",icon:(0,n.jsx)(s,{}),style:{borderRadius:"var(--semi-border-radius-circle)",marginRight:"12px"}}),(0,n.jsx)(d.default,{href:"/upload-manager/add",onClick:e=>{0===L.length&&(e.preventDefault(),Z(),i.P_.info({title:"用户列表为空",position:"top",content:"请先在右侧点击新增用户",duration:3}))},children:(0,n.jsx)(i.zx,{icon:(0,n.jsx)(c.Z,{}),theme:"solid",style:{marginRight:10},children:"新建"})})]})})}),(0,n.jsx)(r,{style:{padding:"24px",backgroundColor:"var(--semi-color-bg-0)"},children:(0,n.jsx)(i.aV,{grid:{gutter:12,xs:24,sm:24,md:12,lg:8,xl:6,xxl:4},dataSource:w,renderItem:t=>(0,n.jsx)(i.aV.Item,{children:(0,n.jsxs)(i.Card,{shadows:"hover",style:{maxWidth:360,margin:"8px 2px",flexGrow:1},bodyStyle:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(e,{title:t.template_name}),(0,n.jsxs)(i.hE,{theme:"borderless",children:[(0,n.jsx)(i.zx,{icon:(0,n.jsx)(u,{})}),(0,n.jsx)(i.zx,{icon:(0,n.jsx)(h.Z,{}),onClick:()=>{g.push("/upload-manager/edit?id=".concat(t.id))}}),(0,n.jsx)(i.gn,{title:"确定是否要删除？",content:"此操作将不可逆",margin:50,onConfirm:async()=>await R(t.id),children:(0,n.jsx)(i.zx,{theme:"borderless",icon:(0,n.jsx)(m.Z,{})})})]})]})})})})]})}},88684:function(e,t,r){"use strict";var n=r(2265);let i=(0,r(26018).A)(function(e){return n.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 5V4H14V5H10ZM8 5V3C8 2.44772 8.44772 2 9 2H15C15.5523 2 16 2.44772 16 3V5H19H20C20.5523 5 21 5.44772 21 6C21 6.55228 20.5523 7 20 7H19V21C19 21.5523 18.5523 22 18 22H6C5.44772 22 5 21.5523 5 21V7H4C3.44772 7 3 6.55228 3 6C3 5.44772 3.44772 5 4 5H5H8ZM15 7H9H7V20H17V7H15ZM9 9.5C9 9.22386 9.22386 9 9.5 9H10.5C10.7761 9 11 9.22386 11 9.5V16.5C11 16.7761 10.7761 17 10.5 17H9.5C9.22386 17 9 16.7761 9 16.5V9.5ZM13 9.5C13 9.22386 13.2239 9 13.5 9H14.5C14.7761 9 15 9.22386 15 9.5V16.5C15 16.7761 14.7761 17 14.5 17H13.5C13.2239 17 13 16.7761 13 16.5V9.5Z",fill:"currentColor"}))},"delete_stroked");t.Z=i},85080:function(e,t,r){"use strict";var n=r(2265);let i=(0,r(26018).A)(function(e){return n.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.1422 4.41421L19.728 3C18.9469 2.21895 17.6806 2.21895 16.8995 3L15.4853 4.41423L14.7782 5.12132L8.31076 11.5888C8.16555 11.734 8.06856 11.9204 8.03299 12.1227L7.42936 15.5547C7.37287 15.8759 7.47654 16.2045 7.70714 16.435C7.93773 16.6656 8.26628 16.7693 8.58746 16.7128L12.0195 16.1092C12.2218 16.0736 12.4082 15.9766 12.5534 15.8314L19.0209 9.36396L19.728 8.65687L21.1422 7.24264C21.9232 6.46159 21.9232 5.19526 21.1422 4.41421ZM19.0209 6.53554L19.728 5.82843L18.3138 4.41421L17.6066 5.12132L19.0209 6.53554ZM17.6066 7.94977L16.1924 6.53555L9.9481 12.7799L9.64628 14.4959L11.3623 14.1941L17.6066 7.94977ZM2 5C2 4.44771 2.44772 4 3 4H10C10.5523 4 11 4.44771 11 5C11 5.55228 10.5523 6 10 6H4V20H18V14C18 13.4477 18.4477 13 19 13C19.5523 13 20 13.4477 20 14V21C20 21.5523 19.5523 22 19 22H3C2.44772 22 2 21.5523 2 21V5Z",fill:"currentColor"}))},"edit_2_stroked");t.Z=i},36710:function(e,t,r){"use strict";var n=r(2265);let i=(0,r(26018).A)(function(e){return n.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23ZM6.5 10.5H17.5C18.3284 10.5 19 11.1716 19 12C19 12.8284 18.3284 13.5 17.5 13.5H6.5C5.67157 13.5 5 12.8284 5 12C5 11.1716 5.67157 10.5 6.5 10.5Z",fill:"currentColor"}))},"minus_circle");t.Z=i},56164:function(e){e.exports={components:"AvatarCard_components__heTwn","semi-icon-close":"AvatarCard_semi-icon-close__9hwya",info:"AvatarCard_info__Gzwh8",name:"AvatarCard_name__mOADG",email:"AvatarCard_email__ncXyR"}}},function(e){e.O(0,[798,674,878,608,328,84,460,862,954,378,617,781,589,971,23,744],function(){return e(e.s=41010)}),_N_E=e.O()}]);