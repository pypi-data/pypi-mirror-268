"use strict";(self.webpackChunk_amphi_pipeline_components_manager=self.webpackChunk_amphi_pipeline_components_manager||[]).push([[719],{7719:(e,t,n)=>{n.r(t),n.d(t,{CodeGenerator:()=>q,ComponentManager:()=>X,PipelineComponent:()=>J,PipelineService:()=>P,default:()=>Q,generateUIFormComponent:()=>j,onChange:()=>O,renderComponentUI:()=>G,renderHandle:()=>W,setDefaultConfig:()=>T});var a=n(7262),l=n(3345),o=n.n(l),r=n(2283),i=n(4393),s=n(473),d=n(6322),c=n(6597),m=n(7638),p=n(9221),u=n(5256);const g="amphi-browseFileDialog-open";class h extends p.BreadCrumbs{constructor(e){super(e),this.model=e.model,this.rootPath=e.rootPath}onUpdateRequest(e){super.onUpdateRequest(e);const t=this.model.manager.services.contents.localPath(this.model.path);t&&this.rootPath&&0===t.indexOf(this.rootPath)&&document.querySelectorAll(".amphi-browseFileDialog .jp-BreadCrumbs > span[title]").forEach((e=>{var t;0===e.title.indexOf(null!==(t=this.rootPath)&&void 0!==t?t:"")?e.className=e.className.replace("amphi-BreadCrumbs-disabled","").trim():-1===e.className.indexOf("amphi-BreadCrumbs-disabled")&&(e.className+=" amphi-BreadCrumbs-disabled")}))}}class v extends u.Widget{constructor(e){super(e),this.model=new p.FilterFileBrowserModel({manager:e.manager,filter:e.filter});const t=this.layout=new u.PanelLayout;this.directoryListing=new p.DirListing({model:this.model}),this.acceptFileOnDblClick=e.acceptFileOnDblClick,this.multiselect=e.multiselect,this.includeDir=e.includeDir,this.dirListingHandleEvent=this.directoryListing.handleEvent,this.directoryListing.handleEvent=e=>{this.handleEvent(e)},this.breadCrumbs=new h({model:this.model,rootPath:e.rootPath}),t.addWidget(this.breadCrumbs),t.addWidget(this.directoryListing)}static async init(e){const t=new v(e);return e.startPath?e.rootPath&&0!==e.startPath.indexOf(e.rootPath)||await t.model.cd(e.startPath):e.rootPath&&await t.model.cd(e.rootPath),t}getValue(){const e=[];for(const t of this.directoryListing.selectedItems())(this.includeDir||"directory"!==t.type)&&e.push(t);return e}handleEvent(e){let t=!1;switch((e instanceof MouseEvent||e instanceof KeyboardEvent)&&(t=e.shiftKey||e.metaKey),e.type){case"keydown":case"keyup":case"mousedown":case"mouseup":case"click":!this.multiselect&&t||this.dirListingHandleEvent.call(this.directoryListing,e);break;case"dblclick":{const t=this.directoryListing.modelForClick(e);if("directory"===(null==t?void 0:t.type))this.dirListingHandleEvent.call(this.directoryListing,e);else if(e.preventDefault(),e.stopPropagation(),this.acceptFileOnDblClick){const e=document.querySelector(`.${g} .jp-mod-accept`);e&&e.click()}break}default:this.dirListingHandleEvent.call(this.directoryListing,e)}}}var f=n(713),y=n(3510);const E=({field:e,handleChange:t,initialValues:n})=>{const[a,i]=(0,l.useState)(n||[{key:"",value:""}]),s=()=>{i([...a,{key:"",value:""}]),t(a,e.id)},d=(n,l,o)=>{const r=[...a];r[l]={...r[l],[o]:n.target.value},i(r),t(r,e.id)};return o().createElement(r.Form.List,{name:"keyValue"},((n,{add:l,remove:c})=>o().createElement(o().Fragment,null,o().createElement(r.Form.Item,null,a.map(((n,l)=>{var s,c;return o().createElement(r.Space,{style:{display:"flex",marginBottom:8},align:"baseline"},o().createElement(r.Input,{name:`${e.id}_key_${l}`,placeholder:(null===(s=e.placeholder)||void 0===s?void 0:s.key)||"key",id:`${e.id}_key_${l}`,value:n.key,onChange:e=>d(e,l,"key"),autoComplete:"off"}),o().createElement(r.Input,{name:`${e.id}_value_${l}`,placeholder:(null===(c=e.placeholder)||void 0===c?void 0:c.value)||"value",id:`${e.id}_value_${l}`,value:n.value,onChange:e=>d(e,l,"value"),autoComplete:"off"}),o().createElement(f.A,{onClick:()=>(n=>{const l=[...a];l.splice(n,1),i(l),t(l,e.id)})(l)}))}))),o().createElement(r.Form.Item,null,o().createElement(r.Button,{type:"dashed",onClick:s,block:!0,icon:o().createElement(y.A,null)},"Add ",e.elementName?e.elementName:"item")))))};var w=n(7664);new w.LabIcon({name:"amphi:trash-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><g fill="currentColor"><path d="M6.25 6a.75.75 0 01.75.75v5.5a.75.75 0 01-1.5 0v-5.5A.75.75 0 016.25 6zM10.5 6.75a.75.75 0 00-1.5 0v5.5a.75.75 0 001.5 0v-5.5z"/><path fill-rule="evenodd" d="M4 3v-.75A2.25 2.25 0 016.25 0h3.5A2.25 2.25 0 0112 2.25V3h2.25a.75.75 0 010 1.5H14v9.25A2.25 2.25 0 0111.75 16h-7.5A2.25 2.25 0 012 13.75V4.5h-.25a.75.75 0 010-1.5H4zm1.5-.75a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75V3h-5v-.75zm-2 2.25v9.25c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75V4.5h-9z" clip-rule="evenodd"/></g></svg>'});const C=new w.LabIcon({name:"amphi:cog-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.78 4.28a.75.75 0 00-1.06-1.06L8 6.94 4.28 3.22a.75.75 0 00-1.06 1.06L6.94 8l-3.72 3.72a.75.75 0 101.06 1.06L8 9.06l3.72 3.72a.75.75 0 101.06-1.06L9.06 8l3.72-3.72z"/></svg>'}),b=new w.LabIcon({name:"amphi:settings-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   width="16"\n   height="16"\n   fill="none"\n   viewBox="0 0 16 16"\n   version="1.1"\n   id="svg2"\n   sodipodi:docname="settings-16.svg"\n   inkscape:version="1.3 (0e150ed, 2023-07-21)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <defs\n     id="defs2" />\n  <sodipodi:namedview\n     id="namedview2"\n     pagecolor="#505050"\n     bordercolor="#eeeeee"\n     borderopacity="1"\n     inkscape:showpageshadow="0"\n     inkscape:pageopacity="0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#505050"\n     inkscape:zoom="34.875"\n     inkscape:cx="8"\n     inkscape:cy="7.9856631"\n     inkscape:window-width="1392"\n     inkscape:window-height="922"\n     inkscape:window-x="0"\n     inkscape:window-y="75"\n     inkscape:window-maximized="0"\n     inkscape:current-layer="svg2" />\n  <g\n     fill="currentColor"\n     fill-rule="evenodd"\n     clip-rule="evenodd"\n     id="g2">\n    <path\n       d="M8 5a3 3 0 100 6 3 3 0 000-6zM6.5 8a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"\n       id="path1" />\n    <path\n       d="M7.5 0a1.75 1.75 0 00-1.75 1.75v.15c-.16.06-.318.125-.472.196l-.106-.106a1.75 1.75 0 00-2.475 0l-.707.707a1.75 1.75 0 000 2.475l.106.106a6.46 6.46 0 00-.196.472h-.15A1.75 1.75 0 000 7.5v1c0 .966.784 1.75 1.75 1.75h.15c.06.16.125.318.196.472l-.106.107a1.75 1.75 0 000 2.474l.707.708a1.75 1.75 0 002.475 0l.106-.107c.154.071.312.137.472.196v.15c0 .966.784 1.75 1.75 1.75h1a1.75 1.75 0 001.75-1.75v-.15c.16-.06.318-.125.472-.196l.106.107a1.75 1.75 0 002.475 0l.707-.707a1.75 1.75 0 000-2.475l-.106-.107c.071-.154.137-.311.196-.472h.15A1.75 1.75 0 0016 8.5v-1a1.75 1.75 0 00-1.75-1.75h-.15a6.455 6.455 0 00-.196-.472l.106-.106a1.75 1.75 0 000-2.475l-.707-.707a1.75 1.75 0 00-2.475 0l-.106.106a6.46 6.46 0 00-.472-.196v-.15A1.75 1.75 0 008.5 0h-1zm-.25 1.75a.25.25 0 01.25-.25h1a.25.25 0 01.25.25v.698c0 .339.227.636.555.724.42.113.817.28 1.186.492a.75.75 0 00.905-.12l.493-.494a.25.25 0 01.354 0l.707.708a.25.25 0 010 .353l-.494.494a.75.75 0 00-.12.904c.213.369.38.767.492 1.186a.75.75 0 00.724.555h.698a.25.25 0 01.25.25v1a.25.25 0 01-.25.25h-.698a.75.75 0 00-.724.555c-.113.42-.28.817-.492 1.186a.75.75 0 00.12.905l.494.493a.25.25 0 010 .354l-.707.707a.25.25 0 01-.354 0l-.494-.494a.75.75 0 00-.904-.12 4.966 4.966 0 01-1.186.492.75.75 0 00-.555.724v.698a.25.25 0 01-.25.25h-1a.25.25 0 01-.25-.25v-.698a.75.75 0 00-.555-.724 4.966 4.966 0 01-1.186-.491.75.75 0 00-.904.12l-.494.493a.25.25 0 01-.354 0l-.707-.707a.25.25 0 010-.354l.494-.493a.75.75 0 00.12-.905 4.966 4.966 0 01-.492-1.186.75.75 0 00-.724-.555H1.75a.25.25 0 01-.25-.25v-1a.25.25 0 01.25-.25h.698a.75.75 0 00.724-.555c.113-.42.28-.817.491-1.186a.75.75 0 00-.12-.904L3.05 4.11a.25.25 0 010-.353l.707-.708a.25.25 0 01.354 0l.493.494c.24.24.611.289.905.12a4.965 4.965 0 011.186-.492.75.75 0 00.555-.724V1.75z"\n       id="path2" />\n  </g>\n</svg>\n'}),x=(new w.LabIcon({name:"amphi:search-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"/></svg>'}),new w.LabIcon({name:"amphi:minus-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M3.5 7.75A.75.75 0 014.25 7h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75z" clip-rule="evenodd"/></svg>'})),S=new w.LabIcon({name:"amphi:plus-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M9 3.5a.75.75 0 00-1.5 0V7H4a.75.75 0 000 1.5h3.5V12A.75.75 0 009 12V8.5h3.5a.75.75 0 000-1.5H9V3.5z"/></svg>'}),k=(new w.LabIcon({name:"amphi:play-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M3 3.814C3 2.436 4.52 1.6 5.684 2.334l6.628 4.186a1.75 1.75 0 010 2.96l-6.628 4.185C4.52 14.401 3 13.564 3 12.185v-8.37zm1.883-.211a.25.25 0 00-.383.211v8.372a.25.25 0 00.383.211l6.628-4.186a.25.25 0 000-.422L4.884 3.603z" clip-rule="evenodd"/></svg>'}),new w.LabIcon({name:"amphi:play-circle-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M7.421 4.356A1.25 1.25 0 005.5 5.411v5.178a1.25 1.25 0 001.921 1.055l4.069-2.59a1.25 1.25 0 000-2.109L7.42 4.356zM10.353 8L7 10.134V5.866L10.353 8z"/><path d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"/></g></svg>'})),I=(new w.LabIcon({name:"amphi:crosshair-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M0 8a8 8 0 1116 0A8 8 0 010 8zm8.75 6.457V12.75a.75.75 0 00-1.5 0v1.707A6.503 6.503 0 011.543 8.75H3.25a.75.75 0 000-1.5H1.543A6.503 6.503 0 017.25 1.543V3.25a.75.75 0 001.5 0V1.543a6.503 6.503 0 015.707 5.707H12.75a.75.75 0 000 1.5h1.707a6.503 6.503 0 01-5.707 5.707z" clip-rule="evenodd"/></svg>'}),new w.LabIcon({name:"amphi:warning-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M8 1a2.143 2.143 0 00-1.827 1.024l-5.88 9.768a2.125 2.125 0 00.762 2.915c.322.188.687.289 1.06.293h11.77a2.143 2.143 0 001.834-1.074 2.126 2.126 0 00-.006-2.124L9.829 2.028A2.149 2.149 0 008 1zM7 11a1 1 0 011-1h.007a1 1 0 110 2H8a1 1 0 01-1-1zm1.75-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" clip-rule="evenodd"/></svg>'}),({field:e,handleChange:t,initialValues:n})=>{const[a,r]=(0,l.useState)(n||[""]);return o().createElement("div",null,a.map(((n,l)=>o().createElement("div",{key:l,className:"flex items-center space-x-2"},o().createElement("input",{type:"text",name:`${e.id}_value_${l}`,placeholder:"Value",id:`${e.id}_value_${l}`,value:n,onChange:n=>((n,l)=>{const o=[...a];o[l]=n.target.value,r(o),t(o,e.id)})(n,l),className:"mt-1 h-6 w-full rounded-sm border-gray-200 shadow-sm sm:text-xs"}),o().createElement("button",{type:"button",onClick:()=>(n=>{const l=[...a];l.splice(n,1),r(l),t(l,e.id)})(l),className:"nodrag flex flex-col justify-center items-center mt-1 w-9 h-6 rounded-sm bg-gray-500 text-white shadow-sm sm:text-xs"},o().createElement(x.react,{className:""}))))),o().createElement("button",{type:"button",onClick:()=>{r([...a,""]),t(a,e.id)},className:"nodrag flex flex-col justify-center items-center mt-2 w-9 h-6 rounded-sm bg-gray-500 text-white shadow-sm sm:text-xs"},o().createElement(S.react,{className:""})))}),N=({field:e,handleChange:t,defaultValue:n,inDialog:a})=>{const i=t=>e.options.find((e=>e.value===t))||{value:t,label:t};(0,l.useEffect)((()=>{g(i(n))}),[n,e.options]);const[s,d]=(0,l.useState)(e.options),[c,m]=(0,l.useState)(""),p=(0,l.useRef)(null),[u,g]=(0,l.useState)(i(n)),h=e=>{e.preventDefault(),d([...s,{value:c,label:c}]),m(""),setTimeout((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),0)},v=e=>{m(e.target.value)};return o().createElement(r.Select,{labelInValue:!0,size:a?"middle":"small",style:{width:"100%"},className:"nodrag",onChange:n=>{g(n),t(null==n?void 0:n.value,e.id)},value:u,placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},dropdownRender:e=>o().createElement(o().Fragment,null,e,o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{padding:"0 8px 4px"}},o().createElement(r.Input,{placeholder:"Custom",ref:p,value:c,onChange:v,onKeyDown:e=>e.stopPropagation()}),o().createElement(r.Button,{type:"text",icon:o().createElement(y.A,null),onClick:h},"Add item"))),options:s.map((e=>({label:e.label,value:e.value})))})},_=({field:e,handleChange:t,defaultValue:n,inDialog:a})=>{(0,l.useEffect)((()=>{c(n)}),[n]);const[i,s]=(0,l.useState)(e.options),[d,c]=(0,l.useState)(n);return o().createElement(r.ConfigProvider,{renderEmpty:()=>o().createElement("span",{style:{display:"none"}})},o().createElement(r.Select,{mode:"tags",labelInValue:!0,size:a?"middle":"small",style:{width:"100%"},className:"nodrag",onChange:n=>{c(n),t(n.map((e=>e.value)),e.id)},value:d,tokenSeparators:[","],placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},options:i.map((e=>({label:e.label,value:e.value})))}))},D=({field:e,handleChange:t,defaultValue:n,inDialog:a})=>{const i=t=>e.options.find((e=>e.value===t))||{value:t,label:t};(0,l.useEffect)((()=>{m(i(n))}),[n,e.options]);const[s,d]=(0,l.useState)(e.options),[c,m]=(0,l.useState)(i(n));return o().createElement(r.Select,{labelInValue:!0,size:a?"middle":"small",style:{width:"100%"},className:"nodrag",onChange:n=>{m(n),t(null==n?void 0:n.value,e.id)},value:c,placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},options:s.map((e=>({label:e.label,value:e.value})))})};class P{static filterPipeline(e){const t=JSON.parse(e).pipelines[0].flow;return{nodes:t.nodes.map((({id:e,type:t,data:n})=>({id:e,type:t,data:n}))),edges:t.edges.map((({id:e,source:t,target:n,targetHandle:a})=>({id:e,source:t,target:n,targetHandle:a})))}}static extractPackageNames(e){const t=new Set(["json","pandas"]);return e.map((e=>{let n="";return n=e.startsWith("import ")?e.split(" ")[1].split(" as ")[0]:e.startsWith("from ")?e.split(" ")[1]:e,t.has(n)?"":n})).filter(((e,t,n)=>e&&n.indexOf(e)===t))}static getInstallCommandsFromPackageNames(e){return e.map((e=>`!pip install ${e} -q -q`))}static extractPythonImportPackages(e){return(e.match(/^(import .+|from .+? import .+)/gm)||[]).map((e=>e.startsWith("from")?e.split(" ")[1].split(".")[0]:e.split(" ")[1]))}static getPipelineRelativeNodePath(e,t){return c.PathExt.relative(c.PathExt.dirname(e),t)}static getComponentIdForFileExtension(e,t){const n=e.name.split(".").pop();if(!n)return{id:null,default:null};const a=t.getComponents();for(const e of a)if(e._fileDrop&&e._fileDrop.includes(n.toLowerCase()))return{id:e._id,default:e._default||null};return{id:null,default:null}}}P.findStartNode=(e,t)=>{const n=new Set;e.edges.forEach((e=>n.add(e.target)));for(const a of e.nodes){const e=t.getComponent(a.type)._type;if(!n.has(a.id)&&"pandas_df_input"===e)return a.id}return null},P.findStartNodes=(e,t)=>{const n=new Set;e.edges.forEach((e=>n.add(e.target)));const a=[];for(const l of e.nodes){const e=t.getComponent(l.type)._type;if(!n.has(l.id)&&"pandas_df_input"===e&&(a.push(l.id),2===a.length))return a}return 1===a.length?a:[]},P.findPreviousNodeId=(e,t)=>{let n="";return e.edges.forEach((e=>{e.target===t&&(n=e.source)})),n},P.findMultiplePreviousNodeIds=(e,t)=>{const n=new Map;e.edges.forEach((e=>{if(e.target===t){console.log("edge %o",e);const t=e.targetHandle||"default";n.has(t)||n.set(t,[]),n.get(t).push(e.source)}})),console.log("previousNodesMap %o",n);const a=Array.from(n.entries()).sort(((e,t)=>e[0].localeCompare(t[0]))).map((([e,t])=>t)).reduce(((e,t)=>e.concat(t)),[]);return console.log("sortedPreviousNodeIds %o",a),a},P.findTwoPreviousNodeIds=(e,t)=>{let n=[];if(e.edges.forEach((e=>{e.target===t&&n.push(e.source)})),2!==n.length)throw new Error("Exactly two previous nodes are not found.");return n};class q{static generateCode(e,t,n){return this.generateCodeForNodes(P.filterPipeline(e),n,"none")}static generateCodeUntil(e,t,n,a){return this.generateCodeForNodes(P.filterPipeline(e),n,a)}}q.generateCodeForNodes=(e,t,n)=>{console.log("generateCodeForNodes initialization");let a="",l=new Map;const o=new Map,r=new Map,i=[],s=new Map,d=new Map,c=new Set,m=new Set,p=new Set;function u(e){const t=l.get(e)||0;l.set(e,t+1)}e.nodes.forEach((e=>{const n=t.getComponent(e.type)._type;"annotation"!==n&&("logger"===n?s.set(e.id,e):o.set(e.id,e))})),console.log("nodesMap %o",o);const g=new Set,h=new Map,v=(t,n)=>{if(g.has(t)){const e=h.get(t)||new Set;return void h.set(t,new Set([...e,...n]))}g.add(t);const a=e.edges.filter((e=>e.target===t)).map((e=>e.source));r.set(t,a);const l=new Set([...n,t]);h.set(t,l),a.forEach((e=>{v(e,l)})),i.push(t)};e.nodes.forEach((e=>{g.has(e.id)||v(e.id,new Set)}));let f=[];if(console.log("nodeDependencies %o",r),console.log("nodePaths %o",h),"none"!==n){let e=new Set([n]),t=new Set;for(;e.size>0;){let n=new Set;e.forEach((e=>{t.add(e),(r.get(e)||[]).forEach((e=>{t.has(e)||n.add(e)}))})),e=n}console.log("nodesToConsider %o",e),f=i.filter((e=>t.has(e))),console.log("nodesToTravser %o",f)}else f=i,console.log("nodesToTravser %o",f);for(const r of f){const i=o.get(r);if(!i){console.error(`Node with id ${r} not found.`);continue}let s=i.data;const p=t.getComponent(i.type),g=t.getComponent(i.type)._type,h=t.getComponent(i.type)._id;"function"==typeof(null==p?void 0:p.provideDependencies)&&p.provideDependencies({config:s}).forEach((e=>m.add(e))),p.provideImports({config:s}).forEach((e=>c.add(e)));let v="",f="";switch(g){case"pandas_df_processor":u(h),v=d.get(P.findPreviousNodeId(e,r)),f=`${i.type}${l.get(h)}`,d.set(r,f),a+=t.getComponent(i.type).generateComponentCode({config:s,inputName:v,outputName:f});break;case"pandas_df_double_processor":const[n,o]=P.findMultiplePreviousNodeIds(e,r);u(h),f=`${i.type}${l.get(h)}`,d.set(i.id,f);const c=d.get(n),m=d.get(o);a+=t.getComponent(i.type).generateComponentCode({config:s,inputName1:c,inputName2:m,outputName:f}),console.log("pandas_df_double_processor");break;case"pandas_df_input":u(h),f=`${i.type}${l.get(h)}`,d.set(r,f),a+=t.getComponent(i.type).generateComponentCode({config:s,outputName:f});break;case"pandas_df_output":u(h),v=d.get(P.findPreviousNodeId(e,r)),a+=t.getComponent(i.type).generateComponentCode({config:s,inputName:v});break;default:console.error("Error generating code.")}console.log("nodeId %o",r),console.log("targetNodeId %o",n),r===n&&(a+="\n"+d.get(r),console.log(a))}if(s.size>0){let e="";s.forEach(((n,a)=>{console.log(`Processing logger with id: ${a}`);const l=t.getComponent(n.type);let o=n.data;"function"==typeof(null==l?void 0:l.provideDependencies)&&l.provideDependencies({config:o}).forEach((e=>m.add(e))),"function"==typeof(null==l?void 0:l.provideFunctions)&&l.provideFunctions({config:o}).forEach((e=>p.add(e))),l.provideImports({config:o}).forEach((e=>c.add(e))),e+=t.getComponent(n.type).generateComponentCode({config:o})}));const n="    ";e=e.split("\n").map((e=>n+e)).join("\n"),a=a.split("\n").map((e=>n+e)).join("\n"),a=`\ntry:\n${a}\nexcept Exception as e:\n    print(f"An error occurred: {e}")\n${e}\n`}else console.log("No loggers found.");const y=new Date;return`# Source code generated by Amphi\n# Date: ${y.getFullYear()}-${(y.getMonth()+1).toString().padStart(2,"0")}-${y.getDate().toString().padStart(2,"0")} ${y.getHours().toString().padStart(2,"0")}:${y.getMinutes().toString().padStart(2,"0")}:${y.getSeconds().toString().padStart(2,"0")}\n# Additional dependencies: ${Array.from(m).join(", ")}\n${Array.from(c).join("\n")}\n${Array.from(p).join("\n\n")}\n${a}`};class F{static retrieveColumns(e,t,n,a,l,o,r,i){o(!0);const s=P.filterPipeline(t.model.toString());let d=q.generateCodeUntil(t.model.toString(),n,a,P.findMultiplePreviousNodeIds(s,r)[i]);const c=d.split("\n"),m=c.pop();m&&m.trim()&&1===m.trim().split(" ").length?(d=c.join("\n"),t.sessionContext.session.kernel.requestExecute({code:d}).onReply=e=>{"ok"==e.content.status?t.sessionContext.session.kernel.requestExecute({code:"print(_amphi_metadatapanel_getcontentof("+m+"))"}).onIOPub=e=>{if("stream"===e.header.msg_type){const t=e;console.log("receive stream %o",t);const n=t.content.text,a=/([^\s,]+)\s+\(([^,]+),\s*(named|unnamed)\)/g,r=[];let i;for(;null!==(i=a.exec(n));){const[e,t,n,a]=i;r.push({value:t,label:t,type:n,named:"named"===a})}console.log(r),console.log("New items %o",r),l((e=>{const t=new Set(e.map((e=>e.value))),n=r.filter((e=>!t.has(e.value)));return[...e,...n]})),o(!1)}else if("error"===e.header.msg_type){o(!1);const t=e.content;console.error(`Received error: ${t.ename}: ${t.evalue}`)}}:("error"==e.content.status||e.content.status,o(!1))}):(o(!1),console.log("output_df is empty, null or not a single word."))}}const A=({field:e,handleChange:t,defaultValues:n,context:a,componentService:i,commands:s,nodeId:d,inDialog:c})=>{const[m,p]=(0,l.useState)(e.options||[]),[u,g]=(0,l.useState)(n),[h,v]=(0,l.useState)(""),f=(0,l.useRef)(null),[E,w]=(0,l.useState)(),C=e.inputNb?e.inputNb-1:0,b=(e,t)=>{const n=e.find((e=>e.value===t));if(n)return{type:n.type,named:n.named}};(0,l.useEffect)((()=>{g(n)}),[n]);const x=e=>{e.preventDefault(),p([...m,{value:h,label:h,type:"object",named:!0}]),v(""),setTimeout((()=>{var e;null===(e=f.current)||void 0===e||e.focus()}),0)},S=e=>{v(e.target.value)};return o().createElement(r.ConfigProvider,{renderEmpty:()=>o().createElement("div",{style:{textAlign:"center"}},o().createElement(r.Empty,{image:r.Empty.PRESENTED_IMAGE_SIMPLE}))},o().createElement(r.Select,{showSearch:!0,mode:"multiple",labelInValue:!0,size:c?"middle":"small",style:{width:"100%"},className:"nodrag",onChange:n=>{g(n);const a=n.map((e=>({...b(m,e.value),value:e.value})));console.log("options %o",a),t(a,e.id)},value:u,placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},dropdownRender:e=>o().createElement(o().Fragment,null,e,o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0 2px 2px"}},o().createElement(r.Button,{type:"primary",onClick:e=>F.retrieveColumns(e,a,s,i,p,w,d,C),loading:E},"Retrieve columns")),o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{padding:"0 8px 4px"}},o().createElement(r.Input,{placeholder:"Custom",ref:f,value:h,onChange:S,onKeyDown:e=>e.stopPropagation()}),o().createElement(r.Button,{type:"text",icon:o().createElement(y.A,null),onClick:x},"Add column"))),options:m.map((e=>({label:e.label,value:e.value,type:e.type}))),optionRender:e=>o().createElement(r.Space,null,o().createElement("span",null," ",e.data.label),o().createElement(r.Tag,null,e.data.type))}))},L=({field:e,handleChange:t,defaultValue:n,context:a,componentService:i,commands:s,nodeId:d,inDialog:c})=>{const m=e=>void 0===e?{}:p.find((t=>t.value===e.value))||{value:e.value,label:e.value};(0,l.useEffect)((()=>{E(m(n))}),[n,e.options]);const[p,u]=(0,l.useState)([]),[g,h]=(0,l.useState)(""),v=(0,l.useRef)(null),[f,E]=(0,l.useState)(m(n)),[w,C]=(0,l.useState)(),b=e.inputNb?e.inputNb-1:0,x=e=>{e.preventDefault(),u([...p,{value:g,label:g,type:"object",named:!0}]),h(""),setTimeout((()=>{var e;null===(e=v.current)||void 0===e||e.focus()}),0)},S=e=>{h(e.target.value)};return o().createElement(r.ConfigProvider,{renderEmpty:()=>o().createElement("div",{style:{textAlign:"center"}},o().createElement(r.Empty,{image:r.Empty.PRESENTED_IMAGE_SIMPLE}))},o().createElement(r.Select,{showSearch:!0,labelInValue:!0,size:c?"middle":"small",style:{width:"100%"},className:"nodrag",onChange:(n,a)=>((n,a)=>{const l=n.value,o=m(l);E(o);const{type:r,named:i}=((e,t)=>{const n=e.find((e=>e.value===t));if(n)return{type:n.type,named:n.named}})(p,l);t({value:l,type:r,named:i},e.id)})(n),value:f,placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},dropdownRender:e=>o().createElement(o().Fragment,null,e,o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0 2px 2px"}},o().createElement(r.Button,{type:"primary",onClick:e=>F.retrieveColumns(e,a,s,i,u,C,d,b),loading:w},"Retrieve columns")),o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{padding:"0 8px 4px"}},o().createElement(r.Input,{placeholder:"Column",ref:v,value:g,onChange:S,onKeyDown:e=>e.stopPropagation()}),o().createElement(r.Button,{type:"text",icon:o().createElement(y.A,null),onClick:x},"Add"))),options:p.map((e=>({label:e.label,value:e.value,type:e.type,named:e.named}))),optionRender:e=>o().createElement(r.Space,null,o().createElement("span",null," ",e.data.label),o().createElement(r.Tag,null,e.data.type))}))},z=({field:e,handleChange:t,initialValues:n,context:a,componentService:i,commands:s,nodeId:d,inDialog:c})=>{const[m,p]=(0,l.useState)(n||[{key:{value:"",type:"",named:!0},value:""}]),[u,g]=(0,l.useState)(),[h,v]=(0,l.useState)([]),E=(0,l.useRef)(null),[w,C]=(0,l.useState)(""),b=()=>{p([...m,{key:"",value:""}]),t(m,e.id)},x=e=>{const t=m.map((e=>e.key)).filter(((t,n)=>n!==e));return h?h.filter((e=>!t.includes(e.value))):[]},S=e=>{C(e.target.value)},k=()=>o().createElement("div",{style:{textAlign:"center"}},o().createElement(r.Empty,{image:r.Empty.PRESENTED_IMAGE_SIMPLE}),o().createElement(r.Button,{type:"primary",onClick:e=>F.retrieveColumns(e,a,s,i,v,g,d,0),loading:u},"Retrieve columns")),I=e=>{e.preventDefault(),v([...h,{value:w,label:w}]),C(""),setTimeout((()=>{var e;null===(e=E.current)||void 0===e||e.focus()}),0)};return console.log("placeholder "+e.placeholder),o().createElement(r.Form.List,{name:"keyValue"},((n,{add:a,remove:l})=>o().createElement(o().Fragment,null,o().createElement(r.Form.Item,null,m.map(((n,a)=>{var l;return o().createElement(r.Space,{style:{display:"flex",width:"100%",marginBottom:8},align:"baseline"},o().createElement(r.ConfigProvider,{renderEmpty:k},o().createElement(r.Select,{labelInValue:!0,size:c?"middle":"small",style:{width:"100%",minWidth:"250px"},className:"nodrag",onChange:n=>{console.log("Value %o",n),((n,a)=>{console.log("VALUE %o",n);const l=n.value,{type:o,named:r}=((e,t)=>{const n=e.find((e=>e.value===t));if(n)return{type:n.type,named:n.named}})(h,l),i=[...m];i[a]={...i[a],key:{value:l,type:o,named:r}},console.log("keyPari %o",i),p(i),t(i,e.id)})(n,a)},value:n.key,options:x(a).map((e=>({label:e.label,value:e.value}))),placeholder:e.placeholder||"Select ...",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{},dropdownRender:e=>o().createElement(o().Fragment,null,e,o().createElement(r.Divider,{style:{margin:"8px 0"}}),o().createElement(r.Space,{style:{padding:"0 8px 4px"}},o().createElement(r.Input,{size:c?"middle":"small",placeholder:"Custom",ref:E,value:w,onChange:S,onKeyDown:e=>e.stopPropagation()}),o().createElement(r.Button,{type:"text",icon:o().createElement(y.A,null),onClick:I},"Add item")))})),o().createElement(r.Input,{size:c?"middle":"small",name:`${e.id}_value_${a}`,placeholder:(null===(l=e.placeholder)||void 0===l?void 0:l.value)||"value",id:`${e.id}_value_${a}`,value:n.value,onChange:n=>((n,a,l)=>{const o=[...m];o[a]={...o[a],[l]:n.target.value},p(o),t(o,e.id)})(n,a,"value"),autoComplete:"off"}),o().createElement(f.A,{onClick:()=>(n=>{const a=[...m];a.splice(n,1),p(a),t(a,e.id)})(a)}))}))),o().createElement(r.Form.Item,null,o().createElement(r.Button,{type:"dashed",onClick:b,block:!0,icon:o().createElement(y.A,null)},"Add ",e.elementName?e.elementName:"item")))))};var M=n(8088),V=n.n(M),$=n(5709),B=n(1029);const R=({field:e,handleChange:t,defaultValue:n,context:a,componentService:i,commands:s,nodeId:d,inDialog:c})=>{const m=({index:e,rowDrop:t,className:n,style:a,...l})=>{const r=o().useRef(),[{isOver:i,dropClassName:s},d]=(0,$.useDrop)({accept:"DragableBodyRow",collect:t=>{const n=t.getItem();return n&&n.index===e?{}:{isOver:t.isOver(),dropClassName:n&&n.index<e?" drop-over-downward":" drop-over-upward"}},drop:n=>{t(n.index,e)}}),[,c]=(0,$.useDrag)({type:"DragableBodyRow",item:{type:"DragableBodyRow",index:e},collect:e=>({isDragging:e.isDragging()})});return d(c(r)),o().createElement("tr",{ref:r,className:`${n}${i?s:""} draggable`,style:{cursor:"move",...a},...l})},[p,u]=(0,l.useState)([]),[g,h]=(0,l.useState)([]);(0,l.useEffect)((()=>{n&&n.sourceData&&n.targetKeys?(console.log("defaultValye: %o",n),u(n.sourceData),h(n.targetKeys)):(u([]),h([]))}),[n]);const v=e=>{const t=P.filterPipeline(a.model.toString());let n=q.generateCodeUntil(a.model.toString(),s,i,P.findPreviousNodeId(t,d));const l=n.split("\n"),o=l.pop();n=l.join("\n"),a.sessionContext.session.kernel.requestExecute({code:n}).onReply=e=>{"ok"==e.content.status?a.sessionContext.session.kernel.requestExecute({code:"print(_amphi_metadatapanel_getcontentof("+o+"))"}).onIOPub=e=>{if("stream"===e.header.msg_type){const t=e.content.text,n=/(\w+)\s+\(([^,]+),\s*(named|unnamed)\)/g,a=[];let l;for(;null!==(l=n.exec(t));){const[e,t,n,o]=l;a.push({value:t,key:t,label:t,type:n,named:"named"===o})}console.log(a),u(a)}else if("error"===e.header.msg_type){const t=e.content;console.error(`Received error: ${t.ename}: ${t.evalue}`)}}:"error"==e.content.status||e.content.status}},f=[{dataIndex:"key",title:"Column"},{dataIndex:"type",title:"Type",render:e=>o().createElement(r.Tag,null,e)}],y=n=>{console.log("nextTargetKeys %o",n),h(n),t({sourceData:p,targetKeys:n},e.id)};return o().createElement(o().Fragment,null,o().createElement((({leftColumns:e,rightColumns:t,...n})=>o().createElement(r.Transfer,{...n},(({direction:n,filteredItems:a,onItemSelectAll:l,onItemSelect:i,selectedKeys:s,disabled:d})=>{const c="left"===n?e:t,p="right"===n?"target":"source",u={getCheckboxProps:e=>({disabled:d||e.disabled}),onSelectAll(e,t){const n=t.filter((e=>!e.disabled)).map((({key:e})=>e)),a=e?V()(n,s):V()(s,n);l(a,e)},onSelect({key:e},t){i(e,t)},selectedRowKeys:s};if("source"===p)return o().createElement(r.Table,{rowSelection:u,columns:c,dataSource:a,size:"small",style:{pointerEvents:d?"none":void 0},onRow:({key:e,disabled:t})=>({onClick:()=>{t||d||i(e,!s.includes(e))}})});{const e=(e,t)=>{let n=[...g];const a=n[e];n.splice(e,1),n.splice(t,0,a),y(n)};return o().createElement($.DndProvider,{backend:B.HTML5Backend},o().createElement(r.Table,{rowSelection:u,columns:c,dataSource:a,components:{body:{row:m}},size:"small",style:{pointerEvents:d?"none":void 0},onRow:({key:t},n)=>({index:n,rowDrop:e,onClick:()=>{i(t,!s.includes(t))}})}))}}))),{dataSource:p,targetKeys:g,showSearch:!0,onChange:y,operations:["include","exclude"],filterOption:(e,t)=>-1!==t.key.indexOf(e)||-1!==t.type.indexOf(e),leftColumns:f,rightColumns:[{dataIndex:"key",title:"Column"}],footer:(e,t)=>{if("left"===(null==t?void 0:t.direction))return o().createElement(r.Button,{type:"primary",size:"small",style:{float:"left",margin:5},onClick:v},"Retrieve columns")}}),o().createElement(r.Space,{style:{marginTop:16}}))},T=({nodeId:e,store:t,setNodes:n,defaultConfig:a})=>{const{nodeInternals:l}=t.getState();n(Array.from(l.values()).map((t=>(t.id===e&&0===Object.keys(t.data).length&&(t.data={...a}),t))))},O=({evtTargetValue:e,field:t,nodeId:n,store:a,setNodes:l})=>{const o=e,{nodeInternals:r}=a.getState();l(Array.from(r.values()).map((e=>{if(e.id===n){let n=t.split(".");if(1===n.length)e.data={...e.data,[t]:o};else{const[t,a]=n;e.data={...e.data,[t]:{...e.data[t],[a]:o}}}}return e})))},j=({nodeId:e,type:t,name:n,form:a,data:i,context:s,componentService:d,manager:c,commands:m,handleChange:p})=>{const[u,g]=(0,l.useState)(!1);return o().createElement(r.ConfigProvider,{theme:{token:{colorPrimary:"#5F9B97"}}},o().createElement(r.Form,{layout:"vertical",size:"small"},H({name:n,nodeId:e,form:a,data:i,context:s,componentService:d,manager:c,commands:m,handleChange:p,advanced:!1}),o().createElement("div",{className:"flex justify-center mt-1 pt-1.5 space-x-4"},o().createElement("span",{onClick:()=>g(!0),className:"inline-flex items-center justify-center cursor-pointer group"},o().createElement(b.react,{className:"h-3 w-3 group-hover:text-primary"})),(t.includes("input")||t.includes("processor"))&&o().createElement("span",{onClick:()=>{m.execute("pipeline-editor:run-pipeline-until",{nodeId:e})},className:"inline-flex items-center justify-center cursor-pointer group"},o().createElement(k.react,{className:"h-3 w-3 group-hover:text-primary"}))),o().createElement(K,{modal2Open:u,setModal2Open:g,name:n,nodeId:e,form:a,data:i,context:s,componentService:d,manager:c,commands:m,handleChange:p,advanced:!0})))},H=({name:e,nodeId:t,form:n,data:a,context:p,componentService:u,manager:h,commands:f,handleChange:y,advanced:w})=>o().createElement(o().Fragment,null,n.fields.map(((e,n)=>{if(!w&&e.advanced)return null;let C,b=[];const x=e.id.split(".");if(Array.isArray(a[e.id]))b=a[e.id];else if(1===x.length)void 0!==a[e.id]&&(C=a[e.id]);else{const[e,t]=x;a[e]&&void 0!==a[e][t]&&(C=a[e][t])}const[S,k]=(0,l.useState)(!1);switch((0,l.useEffect)((()=>{(t=>{if(e.validation){const n=new RegExp(e.validation,"i");k(!n.test(t))}else k(!1)})(C)}),[C]),e.type){case"input":return o().createElement(r.Form.Item,{style:{marginTop:"5px",padding:"0 0 2px"},label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.Input,{id:e.id,size:w?"middle":"small",name:e.id,placeholder:e.placeholder,onChange:t=>y(t.target.value,e.id),value:C,autoComplete:"off"}));case"radio":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.Flex,{vertical:!0,gap:"middle"},o().createElement(r.Radio.Group,{defaultValue:C,onChange:t=>y(t.target.value,e.id),buttonStyle:"solid"},e.options.map((e=>o().createElement(r.Radio.Button,{value:e.value},e.label))))));case"file":return o().createElement(r.Form.Item,{style:{marginTop:"5px",padding:"0 0 2px"},label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.Space.Compact,{style:{width:"100%"}},o().createElement(r.Input,{id:e.id,size:w?"middle":"small",name:e.id,placeholder:e.placeholder,onChange:t=>y(t.target.value,e.id),value:C,...S?{status:"warning"}:{}}),o().createElement(r.Button,{type:"primary",size:w?"middle":"small",onClick:async()=>{c.PathExt.resolve("/",c.PathExt.dirname(p.path));const t=await(async(e,t)=>{const n=await v.init({manager:e,filter:t.filter,multiselect:t.multiselect,includeDir:t.includeDir,rootPath:t.rootPath,startPath:t.startPath,acceptFileOnDblClick:!Object.prototype.hasOwnProperty.call(t,"acceptFileOnDblClick")||t.acceptFileOnDblClick}),a=new m.Dialog({title:"Select a file",body:n,buttons:[m.Dialog.cancelButton(),m.Dialog.okButton({label:"Select"})]});return a.addClass("amphi-browseFileDialog"),document.body.className+=` ${g}`,a.launch().then((e=>{if(document.body.className=document.body.className.replace(g,"").trim(),t.rootPath&&e.button.accept&&e.value.length){const n=t.rootPath.endsWith("/")?t.rootPath:t.rootPath+"/";e.value.forEach((e=>{e.path=e.path.replace(n,"")}))}return e}))})(h,{multiselect:!1,includeDir:!0,rootPath:c.PathExt.dirname(p.path),filter:e=>e.path!==p.path});y(t.value[0].path,e.id)}},o().createElement(i.A,null))));case"columns":return o().createElement(r.Form.Item,{style:{marginTop:"5px",padding:"0 0 2px"},label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(A,{field:e,handleChange:y,defaultValues:b,context:p,componentService:u,commands:f,nodeId:t,inDialog:w}));case"column":return o().createElement(r.Form.Item,{style:{marginTop:"5px",padding:"0 0 2px"},label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(L,{field:e,handleChange:y,defaultValue:C,context:p,componentService:u,commands:f,nodeId:t,inDialog:w}));case"selectCustomizable":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(N,{field:e,handleChange:y,defaultValue:C,inDialog:w}));case"selectTokenization":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(_,{field:e,handleChange:y,defaultValue:C,inDialog:w}));case"select":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(D,{field:e,handleChange:y,defaultValue:C,inDialog:w}));case"textarea":const{TextArea:n}=r.Input;return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(n,{id:e.id,name:e.id,placeholder:e.placeholder,onChange:t=>y(t.target.value,e.id),value:C,autoComplete:"off",rows:4}));case"boolean":return o().createElement(r.Form.Item,{style:{marginTop:"5px",padding:"0 0 2px"},label:e.label,...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.Switch,{onChange:t=>y(t,e.id),checkedChildren:o().createElement(s.A,null),unCheckedChildren:o().createElement(d.A,null),defaultChecked:!0===C}));case"cascader":const a=e=>e[e.length-1];return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.Cascader,{value:b,placeholder:e.placeholder,options:e.options,displayRender:a,onChange:t=>y(t,e.id)}));case"keyvalue":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(E,{field:e,handleChange:y,initialValues:b}));case"keyvalueColumns":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(z,{field:e,handleChange:y,initialValues:b,context:p,componentService:u,commands:f,nodeId:t,inDialog:w}));case"valuesList":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(I,{field:e,handleChange:y,initialValues:b}));case"inputNumber":return o().createElement(r.Form.Item,{label:e.label,className:"nodrag",...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(r.InputNumber,{...e.min?{min:e.min}:{},...e.max?{max:e.max}:{},id:e.id,name:e.id,value:C,onChange:t=>y(t,e.id),changeOnWheel:!0}));case"transferData":return o().createElement(r.Form.Item,{label:e.label,...e.required?{required:e.required}:{},...e.tooltip?{tooltip:e.tooltip}:{}},o().createElement(R,{field:e,handleChange:y,defaultValue:C,context:p,componentService:u,commands:f,nodeId:t,inDialog:w}));default:return null}})));function K({name:e,nodeId:t,form:n,data:a,context:l,componentService:i,manager:s,commands:d,handleChange:c,advanced:m,modal2Open:p,setModal2Open:u}){return o().createElement(o().Fragment,null,o().createElement(r.Modal,{title:e,centered:!0,open:p,onOk:()=>u(!1),onCancel:()=>u(!1),width:800},o().createElement(r.Form,{layout:"vertical"},H({name:e,nodeId:t,form:n,data:a,context:l,componentService:i,manager:s,commands:d,handleChange:c,advanced:!0}))))}var U=n(7012);const W=({type:e,Handle:t,Position:n,internals:a})=>{const r=e=>{const{nodeInternals:n,edges:r,nodeId:i}=a,s=(0,l.useMemo)((()=>{if("function"==typeof e.isConnectable){const t=n.get(i),a=(0,U.AX)([t],r).filter((t=>t.target===i&&e.id===t.targetHandle));return e.isConnectable({node:t,connectedEdges:a})}if("number"==typeof e.isConnectable){const t=n.get(i);return(0,U.AX)([t],r).filter((t=>t.target===i&&e.id===t.targetHandle)).length<e.isConnectable}return e.isConnectable}),[n,r,i,e.isConnectable,e.id]);return o().createElement(t,{...e,isConnectable:s})};switch(e){case"pandas_df_input":return o().createElement(t,{className:"handle-right",type:"source",position:n.Right,id:"out"});case"pandas_df_output":return o().createElement(r,{type:"target",position:n.Left,isConnectable:1,className:"handle-left",id:"in"});case"pandas_df_processor":return o().createElement(o().Fragment,null,o().createElement(r,{type:"target",position:n.Left,isConnectable:1,className:"handle-left",id:"in"}),o().createElement(t,{className:"handle-right",type:"source",position:n.Right,id:"out"}));case"pandas_df_double_processor":return o().createElement(o().Fragment,null,o().createElement(r,{type:"target",position:n.Left,isConnectable:1,className:"handle-left",id:"in1"}),o().createElement(r,{type:"target",position:n.Left,isConnectable:1,className:"second-handle-left",id:"in2"}),o().createElement(t,{className:"handle-right",type:"source",position:n.Right,id:"out"}));default:return null}},G=({id:e,data:t,context:n,manager:a,commands:l,name:r,ConfigForm:i,Icon:s,showContent:d,handle:c,deleteNode:m,setViewport:p})=>o().createElement(o().Fragment,null,o().createElement("div",{className:"component",onDoubleClick:()=>{p({zoom:1.2,duration:500})}},o().createElement("div",{className:"component__header"},r,o().createElement("div",{onClick:m,className:"deletebutton"},o().createElement(C.react,{className:"group-hover:text-primary"}))),o().createElement("div",{className:"component__body"},o().createElement("form",null,d?i:o().createElement("div",{className:"placeholder"},o().createElement(s.react,{top:"8px",height:"32px",width:"32px;",color:"#5A8F7B",verticalAlign:"middle"})))),c));function J(){return class{constructor(){}static getInstance(){return this.instance||(this.instance=new this),this.instance}static get Name(){return this.getInstance()._name}static get Type(){return this.getInstance()._type}static get Icon(){return this.getInstance()._icon}static get Default(){return this.getInstance()._default}static get Form(){return this.getInstance()._form}}}const X=new a.Token("@amphi/pipeline-components-manager:provider");class Y{constructor(){this._components=[],this._components=[]}getComponents(){return this._components}getComponent(e){return this._components.find((t=>t._id===e))}addComponent(e){this._components.push(e)}getComponentCount(){return this._components.length}}const Q={id:"@amphi/pipeline-components-manager:plugin",description:'Provider plugin for the pipeline editor\'s "component" service object.',autoStart:!0,provides:X,activate:()=>(console.log("JupyterLab extension (@amphi/pipeline-components-manager/provider plugin) is activated!"),new Y)}}}]);